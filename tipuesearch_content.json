{"pages":[{"text":"野下 浩司 （のした こうじ） 研究内容 生物や生物のつくる構造物のかたちを理論的に研究しています． 腹足類（巻貝）の殻のかたち 植物のかたち 考古遺物のかたち 現所属 東京大学 農学生命科学研究科 生産・環境生物学専攻 生物測定学研究室 03-5841-5068 noshita at morphometrics.jp 経歴 平成18（2006）年4月 – 平成22（2010）年3月 静岡大学 理学部 地球科学科 平成22（2010）年4月 – 平成27（2015）年3月 九州大学大学院 システム生命科学府 平成22（2010）年4月 – 平成24（2012）年3月 平成25（2013）年4月 – 平成26（2014）年3月 九州大学理学部TA 平成24（2012）年4月 – 平成27（2015）年3月 日本学術振興会特別研究員(DC1) 2013年1月23日 – 2013年2月11日 腹足類殻形態の定量化と多様性評価のための標本の撮影 in National Museum of Natural History （アメリカ），受入研究者 Ellen Strong 地球規模での保全生態学推進のための若手研究者海外派遣プログラム 2013 年 9 月 17日-9 月 29 日 生物多様性保全策実施のための魚類調査 マレーシア(サラワク州ビンツル周辺の河川) 自然共生社会を拓くアジア保全生態学(九州大学 GCOE プログラム) 2014 年 1 月 29 日-2014 年 2 月 20 日 標本の撮影と測定 in National Museum of Natural History （アメリカ），受入研究者 Robert Hershler 自然共生社会を拓くアジア保全生態学(九州大学 GCOE プログラム) 2014 年 4月 1日-2014 年 11月 30日 Visiting Scholar in Plotkin Research Group，UPenn （アメリカ） 平成27（2015）年4月 – 現在 東京大学 農学生命科学研究科 特任研究員 受賞 平成24年1月 日本古生物学会 ポスター賞（第161回例会） 平成24年5月 日本学生支援機構 特に優れた業績による全額返還免除 外部研究資金 日本学術振興会 科学研究費補助金DC1（特別研究員奨励費），形態の適応と形成過程の数理的研究，代表者：野下浩司，H24－H27 査読経験 Journal of Marine Biology 所属学会 2009年 – 現在 日本古生物学会 2010年 – 現在 日本進化学会 2010年 – 現在 日本数理生物学会 2011年 – 現在 日本生態学会 2011年 – 現在 日本発生生物学会 2012年 – 現在 The Society for the Study of Evolution","title":"About","tags":"pages","url":"http://noshita.github.io/pages/profile.html"},{"text":"活動 これから 2016.03.20-24 生態学会 これまで 2015.12.15 進化古生物学セミナー（東京大学） で発表しました． 2015.12.06-12 オーストラリアにいました． 2015.10.03-14 形質調査のためメキシコにいました． 2015.09.11-12 育種学会 ワークショップW05「育種学と農学のこれからを考える30 〜フェノタイピングは頭痛の種？〜」 で講演しました． 2015.08.26-29 数理生物学会 2015.08.20-22 進化学会","title":"Activities","tags":"pages","url":"http://noshita.github.io/pages/activities.html"},{"text":"トピック 初級 離散ロジスティックモデル 指数増殖 ロジスティック成長 ロトカ・ボルテラ モデル（被食-捕食系） ロトカ・ボルテラ モデル（競争系と共生系） 中級 Raupモデル データ解析の基礎 疫学モデル セル・オートマトン ライフゲーム フレンチフラッグモデル 反応拡散系 上級 セルラーポッツモデル バーテックスダイナミクス カナリゼーションモデル 最先端 ? 補足 コンピュータ関係 プログラミング環境の導入 数理生物学 アイソクライン法 局所安定性解析 確率分布いろいろ 数値計算 リンク CとSageによる数理生物学演習 2012年に数理生物学演習のTAを担当した時の資料の一部．","title":"Computational Biology","tags":"compbio","url":"http://noshita.github.io/pages/compbio.html"},{"text":"データ スイスロール 3次元空間に埋め込まれた2次元多様体上に分布するデータ． オリジナルはよくわらかない． scikit-learnでは生成アルゴリズムとして S. Marsland, \"Machine Learning: An Algorithmic Perspective\", Chapter 10, 2009.の lle.pyが引用されている． 画像データセット","title":"Datasets","tags":"pages","url":"http://noshita.github.io/pages/datasets.html"},{"text":"資料 育種学会2015秋 若手の会ワークショップ 育種学会で講演した時の補足資料． 葉の輪郭形状を楕円フーリエで定量化する流れを解説した． 使ったツールはFijiとR． 楕円フーリエ解析はRパッケージのMomocsを使用．","title":"Morphometrics","tags":"morphometrics","url":"http://noshita.github.io/pages/morphometrics.html"},{"text":"Morphometrics 形態測定学についての記事など． S&M SageとMathematicaで色々な計算をやってみた記録． Computational Biology 生物学のトピックを主に計算機を使って解析する．","title":"Notes","tags":"pages","url":"http://noshita.github.io/pages/notes.html"},{"text":"論文 査読あり Noshita, K. , Shimizu, K., and Sasaki, T. Geometric analysis and estimation of the growth rate gradient on gastropod shells. Journal of Theoretical Biology (2016), 389 , pp. 11–19. http://doi.org/10.1016/j.jtbi.2015.10.011 Noshita, K. Quantification and geometric analysis of coiling patterns in gastropod shells based on 3D and 2D image data. Journal of Theoretical Biology (2014) 363 , pp. 93-104. http://doi.org/10.1016/j.jtbi.2014.08.010 Noshita, K. , Asami, T. and Ubukata, T. Functional constraints on coiling geometry and aperture inclination in gastropods. Paleobiology (2012) 39 (2), pp. 322–334. http://dx.doi.org/10.1666/10060.1 その他 野下浩司 腹足類殻形態への理論形学的アプローチ 日本数理生物学会ニュースレター (2012) 67 , pp. 18-19. 野下浩司 巻貝殻形態の理論形態学的解析パッケージ：Spiral Shell Form. 静岡大学地球科学研究報告 (2010) 37 , pp. 57–73. 発表 国際学会 口頭 Noshita, K. , Shimizu, K., Sasaki, T. Estimation of the growth rate gradient on molluscan shells: From shape to growth. 2015 Joint Meeting of The 5th China-Japan-Korea Colloquium on Mathematical Biology and The Japanese Society for Mathematical Biology. Doshisha University, Kyoto, Japan. Aug. 28, 2015. Noshita, K. The difference of morphological diversity between land and marine gastropod shells. 2014 ESA Annual Meeting. Sacramento Convention Center, CA, USA. Aug. 2014（査読あり）. Noshita, K. Quantification of coiling patterns in gastropod shells and evaluation of functional traits. Evolution2014. Raleigh Convention Center, NC, USA. June 2014. ポスター Noshita, K. \"Theoretical morphological approach to the diversity of gastropod shells\" 1st Joint Congress on Evolutionary Biology（Ottawa, Canada） 2012/7/7 Noshita, K. Morphological adaptation to fluid environments in gastropods. ESJ59/EAFES5（滋賀） 2012/3 国内学会 口頭 野下浩司 . 貝殻形態からその成長様式へ：成長管モデルとGrowth Vector Map．日本古生物学会第164回例会（豊橋市自然史博物館，愛知）口頭． 2015/1/31 野下浩司 腹足類殻の巻きパタン定量化から防御形質評価まで.日本生態学会第 61 回全国大会 W16-1 広島国際会議場 2014年 3 月(自由集会) 野下浩司 腹足類殻の巻きパタンの定量化:成長管モデルパラメータ一定の場合 日本古生物学会 2014 年年会 B04 2014 年1月 野下浩司 腹足類殻の\"巻き\"パタンの定量化.日本数理生物学会第 23 回大会 S1-1 静岡大学 2013 年 9 月(シンポジウム) 野下浩司 腹足類殻の\"巻き\"パタンの3Dおよび2Dイメージデータに基づく定量化法. 日本古生物学会2013年年会（熊本） 2013年6月29日 野下浩司 腹足類の殻形態と物理的制約への理論形態学的アプローチ. 日本生態学会第60回全国大会（自由集会，静岡） 2013年3月5日 野下浩司 腹足類穀形態の物理的環境への適応. 日本数理生物学会第21回大会（自由集会，岡山） 2012年9月11日 唐沢與希, 前田晴良, 野下浩司 Hypophylloceras属の殻に見られる特異的な破損パターン. 第161回日本古生物学会例会（） 2012年1月21日 野下浩司 ホヤ脊索における収斂伸長. 日本数理生物学会第21回大会（） 2011年9月 野下浩司 腹足類の殻口の傾きと生息環境. 日本古生物学会2011年年会（） 2011年7月 野下浩司 腹足類に殻口の傾きにおける制約. 日本生態学会第58回大会（） 2011年3月 野下浩司 , 浅見崇比呂, 生形貴男 腹足類の殻形態における制約. 日本数理生物学会第20回大会（） 2010年9月 野下浩司 , 浅見崇比呂, 生形貴男 腹足類の形態的多様性の制約. 日本古生物学会2010年年会（） 2010年6月 ポスター 唐沢與希, 野下浩司 , 前田晴良 アンモノイド類の殻断面形態の力学特性. 日本古生物学会2015年年会（産業技術総合研究所，茨城） 2015/6/27 野下浩司 . 腹足類の殻に保存された成長の記録. 日本生態学会第62回全国大会（鹿児島大学，鹿児島） 2015/3/19 野下浩司 . 腹足類殻形態の定量化と機能評価.日本生態学会第 61 回全国大会 PA2-013 広島国際会議場 2014年3月 野下浩司 腹足類殻形態の定量化フレームワーク構築に向けて. 日本生態学会第60回全国大会（静岡） 2013年3月6日 野下浩司 腹足類の殻口の傾き. 第161回日本古生物学会例会（） 2012年1月21日 ポスター賞 野下浩司 , 浅見崇比呂, 生形貴男 腹足類における機能的トレードオフ. 第12回日本進化学会大会（） 2010年8月 企画 [自由集会@ESJ] 清水啓介, 野下浩司 貝類を通して生命現象に迫る 3: 行動 . 日本生態学会第 62 回全国大会 W27 鹿児島大学 2015 年 3 月 [自由集会@ESJ] 野下浩司 , 清水啓介 貝類を通して生命現象に迫る 2: 生物間相互作用 . 日本生態学会第 61 回全国大会 W16 広島国際会議場 2014 年 3月 [シンポジウム@JSMB] 野下浩司 生物のかたちを測る:変形・成長.多様性を定量化するために. 日本数理生物学会第 23 回大会 S1 静岡大学 2013 年9月 [自由集会@ESJ] 野下浩司 , 清水啓介 貝類を通して生命現象に迫る：進化・生態・発生 . 日本生態学会第60回全国大会 2013年3月5日 [シンポジウム@JSMB] 野下浩司 生物のかたちを理解するための数理的手法：発生から適応まで. 第22回日本数理生物学会大会 2012年9月11日 招待講演 野下浩司 「かたち」と「かたち作り」を測る：形態測定学・理論形態学の活用． 進化古生物学セミナー（企画：遠藤一佳） 東京大学 2015/12/15 野下浩司 植物器官の効率的フェノタイピング：画像解析と形態測定学. 日本育種学会第128回講演会（平成27年度秋季大会）ワークショップ「W05: 育種学と農学のこれからを考える30 〜フェノタイピングは頭痛の種？〜」 新潟大学 2015/9/11 野下浩司 形態測定学の進化生物学における活用：細胞から個体，人工物まで. 日本進化学会第17回大会ワークショップ「W-03: 日本の考古遺物を中心とした文化進化的考察」 中央大学 2015/8/20 野下浩司 CTデータを利用した腹足類殻形態の定量化． 動物生態学研究室ゲストセミナー（企画：細将貴） 京都大学 2015/2/2 野下浩司 腹足類殻形態の定量化と機能評価：測定手法の開発と形態の生態学的意義を探る． 東京大学 農学部 生産・環境専攻セミナー（企画：岩田洋佳） 2014/3/11 野下浩司 生物のかたちのモデリングと定量化:3D イメージデータが拓く個体発生解析の可能性と 2D イメージデータの有効活用. 第 45回種生物シンポジウム 別府市ふれあい広場サザンクロス 2013/11/30 野下浩司 Theoretical morphological study on gastropod shell forms. 明治大学 GCOE MEE Seminar 2012年1月 その他 Noshita, K. University of Pennsylvania Plotkin Lab. Seminar 2014 年 4 月 Noshita, K. Geometric Analysis and Quantification of Coiling-Patterns of Gastropod Shells based on 3D and 2D Image Data. 九州大学 数理生物学研究室 MEセミナー 2013年4月23日 Noshita, K. The difference of aperture inclination between land and marine snails. 九州大学 数理生物学研究室 MEセミナー 2011年2月22日 Noshita, K. Convergent extension of ascidian notochord. 九州大学 数理生物学研究室 MEセミナー 2010年12月20日 Noshita, K. Constraint of morphological variation in gastropod snails. 九州大学 数理生物学研究室 MEセミナー 2010年5月11日","title":"Publications","tags":"pages","url":"http://noshita.github.io/pages/publications.html"},{"text":"腹足類の殻形態 植物の分岐パタン 土器","title":"Research","tags":"pages","url":"http://noshita.github.io/pages/research.html"},{"text":"数学のためのソフトウェアたち Sage Mathematica","title":"S","tags":"pages","url":"http://noshita.github.io/pages/sandm.html"},{"text":"葉の輪郭形状解析 (Chitwood et al. 2012) を例に，葉の輪郭形状解析からどのような生物学的・農学的知見が明らかにできるかを紹介しました． また，輪郭形状解析によく用いられる楕円フーリエ解析をFijiとRを利用しておこなう手順を例示しました． ここでは，FijiとRを利用した楕円フーリエ解析の流れをより具体的に解説します． 使うツールやデータ Fiji ImageJ の生命科学系プラグインのバンドル版． 今回は 領域分割 二値化 エッヂ検出 に用います． 参考: インストール方法（ Installation ） 基本的な使い方（ Tutorials ） Getting started Image Processing Principles Cookbook Using the Script Editor 様々なプラグイン（ Plugins ） R 統計解析用プログラミング言語，またはその実装． 今回ははR及びそのパッケージの Momocs を用いて， エッヂ検出 楕円フーリエ解析 主成分分析 形態の再構築 をおこないます． Momocs 主に輪郭形状解析を目的としたRのパッケージ． 現在も開発中ですので，開発者のGitHubレポジトリから最新版をインストールします． GitHubからのインストールにはdevtools( GitHub , CRAN )を利用しますので， Windowsでは Rtools Macでは Xcode Linuxでは各種コンパイラやライブラリ がそれぞれ必要となります． 以下では，WindowsとMacでのMomocsのインストールまでの手順を説明します． Linuxの方は各自頑張れると思います． Windows Mac サンプルデータ ワークショップではChitwood LabのWebページで公開しているトマトの野生種の画像データベースのサンプルを利用しました． これらのデータは (Chitwood et al. 2012) の解析に実際に用いられたデータセットです． しかし，著作権的な問題のため，ここにそれらデータを転載することはしません． 興味がある方は Chitwood Lab の Wild relatives of tomato | Database を参照して下さい． 代わりに，ここでは (Chitwood et al. 2015) のブドウの野生種の葉の画像データの一部を楕円フーリエ解析の具体的な手順の説明に用います． データは Harverd Dataverse にて CC0 で公開されています． Climate and developmental plasticity: interannual variability in grapevine leaf morphology ここでは，このデータセットから10枚の葉の画像を抜き出したサンプルデータを利用します． 解析手順 準備 サンプルデータとコード一式は こちら からダウンロードできます． これを解凍し，作業ディレクトリとします． 作業ディレクトリは，このような構成になっていると想定します． wsJBS2015Aut data image001.jpg image002.jpg ... fijiSample.ijm rSample.r 作業ディレクトリの構成を維持しておけば，作業ディレクトリ自体はどこに配置しても構いません． Fijiでの前処理 画像をFijiに読み込み解析を開始します． 画像の取り込みはドラッグ&ドロップまたは「File」→「Open...」を選択し行います． 1. 領域分割 Fijiには幾つかの領域分割のためプラグインが導入されています．． ここでは，もっと単純な閾値による分割，インタラクティブなGraph Cutによる分割とLevel Setによる分割を紹介します． 1.1 閾値 1.2 Graph Cut 1.3 Level Set これらの他にもFijiには領域分割のためのプラグインが複数あります． 「Plugin」→「Segmentation」で利用できるので試してみて下さい． 2. 二値化 3. エッヂ検出 Rでの輪郭形状解析と統計処理 1. エッヂ検出 2. 楕円フーリエ解析 # Momocsの準備 >> devtools :: install_github ( \"vbonhomme/Momocs\" , build_vignettes = TRUE ) >> library ( Momocs ) # ファイルの読み込み lf <- list.files('/Users/Noshita/ownCloud/講義計画/morphometrics_WS_JSB/data/Noshita/croped', full.names=TRUE) cooList <- import_jpg(lf) coo <- Out(cooList) #図を重ねて表示 stack(coo) # フーリエ係数の計算 cooA <- coo_align(coo) efList <- list(1:10) efiList <- list(1:10) #ef <- efourier(cooA[1],40,norm=TRUE) #efi <- efourier_i(ef,40) #coo_plot(efi) x = 0 for (i in 1:10) { x <- x+1 ef <- efourier(cooA[x],40,norm=T) efList[[x]] <- ef efi <- efourier_i(ef,40) efiList[[x]] <- efi } stack(Out(efiList)) 3. 主成分分析 4. 形状の再構築 もう少し踏み込んだ解析 本節は加筆中です．しばらくお待ち下さい． 楕円フーリエ解析で輪郭形状を定量化・再構築できることがわかりました． しかし，それだけで科学的に面白い知見が得られる訳ではありません． 以下では，幾つかのもう少し踏み込んだ解析例を紹介します． 輪郭形状の左右成分の分離 詳細は (Iwata et al. 1998) を参照． 種間での輪郭形状差の検出 左右・遠位-近位での輪郭形状差の検出 成長に伴う輪郭形状の変化 GWASやGSへの応用 参考文献 (Chitwood et al. 2012), Chitwood, D. H. et al., The Developmental Trajectory of Leaflet Morphology in Wild Tomato Species , 158 (3), 1230–1240. (Chitwood et al. 2015), Chitwood, Daniel H et al., Climate and developmental plasticity : interannual variability in grapevine leaf morphology To whom correspondence should be addressed (314). (Iwata et al. 1998), Iwata, Hiroyoshi et al., Evaluation of variation of root shape of Japanese radish (Raphanus sativus L.) based on image analysis using elliptic Fourier descriptors , Euphytica, 102 (2), 143–149, http://link.springer.com/10.1023/A:1018392531226 . リンク 育種学と農学のこれからを考える30 〜フェノタイピングは頭痛の種？〜 育種学会（第128回講演会）@新潟大学 育種学会","title":"育種学会2015秋　若手の会ワークショップ","tags":"morphometrics","url":"http://noshita.github.io/pages/workshop2015_jsb.html"},{"text":"概要 腹足類（巻貝）の殻の形態をコントロールする殻成長の勾配パタンをCTデータから定量化する手法を開発しました． 腹足類の殻は殻口縁辺部で炭酸カルシウムの結晶を少しずつ付加しながら成長します． 殻の\"外側\"が\"内側\"に比べ大きく成長することで，多くの腹足類では殻が巻くことになります（下図）． 本研究は，こうして出来上がった殻が，どのような成長勾配のパタンから生じたかを定量的に検証するための解析手法を提供します． 本手法は，殻の巻きパタンと殻口の形状が成長に伴い変化する場合（ヘビガイやノタウチガイなどの\"異常巻き\"巻貝）にも適用できるようデザインされています． 本手法はマイクロCTスキャナーのデータ（3Dボクセルデータ）の利用を想定しています． 今後のCTデータの普及にともない活用できるケースが増えてくると考えています． 本研究は， 清水啓介 博士（JAMSTEC）と 佐々木猛智 准教授（東京大学総合研究博物館）との共同研究です． 論文情報 Noshita, K. , Shimizu, K., & Sasaki, T. (2016). Geometric analysis and estimation of the growth rate gradient on gastropod shells. Journal of Theoretical Biology, 389(C), 11–19. http://doi.org/10.1016/j.jtbi.2015.10.011","title":"論文が出版されました","tags":"News","url":"http://noshita.github.io/posts/00005.html"},{"text":"問題 Harvard Dataverse に保存されている あるdatasetから画像データを一括で保存しようとしたらサイズ制限のため ***.jpeg (image/jpeg) **** bytes. ***.jpeg (image/jpeg) skipped because the total size of the download bundle exceeded the limit of ** bytes. ***.jpeg (image/jpeg) skipped because the total size of the download bundle exceeded the limit of ** bytes. ... みたいな記述のMANIFEST.TEXを含んだzipファイルがダウンロードされる． 結果として，数個しか画像データがダウンロード出来ない． 手動で一個一個ファイルを落とすなんてイヤだ． 解決策 画像データそれぞれのurlを取得して，保存する． 手順 特定のdataverseがもつfileの一覧を取得する dataverseのAPI を見ると Search API があるらしいので，これに従い取得する． とりあえずブラウザで確認したいって人は https://dataverse.harvard.edu/api/search?=q=*&subtree=[dataverseのid]&type=file&key=[APIトークン] でチェック． [dataverseのid]は欲しいデータをもつdatasetが含まれるdataverseのidを指定する． idはdataverseのurlからわかる． https://dataverse.harvard.edu/dataverse/[dataverseのid] [APIトークン]はHarvard Dataverseにアカウントを作ると，生成できる． 参照: Account Creation & Management 今回はcURLで curl -X GET https://dataverse.harvard.edu/api/search?=q=*\\&subtree=[特定のdataverseのid]\\&type=file\\&key=[APIトークン] > [保存先のファイル名].json のようにしてjsonファイルとして保存する． 今回はfilelist.jsonとして保存したとして話を進める． 特定のdatasetがもつfileの一覧を取得できたら早いのだが， subtreeオプションやfqオプションでは対応できなさそう． なので一旦全部ダウンロードしてから適当なfileだけを選び出す． 必要なfileの取捨選択 取得したjsonファイルを読み込んでフィールドの値に応じて必要なfileをフィルタリングする． 今回はpythonを利用した． 大体こんな感じ． import re , json # fileの情報一覧の読み込み with open ( \"filelist.json\" , \"r\" ) as f : filelist = json . load ( f ) # 特定のデータセットを指定するパタン # 今回はDOIで指定する PTNDOI = re . compile ( r\"[データセットを指定するDOI]\" ) # 欲しいfileの種類を指定するパタン PTNTYPE = re . compile ( r\"[fileのtype，e.g. 拡張子]\" ) # 必要なfile一覧の生成 targetlist = [] for item in filelist : if PTNDOI . search ( item [ 'dataset_citation' ]) is not None : if PTNTYPE . search ( item [ 'file_type' ]) is not None : targetlist . append (( item [ 'name' ], item [ 'url' ])) [データセットを指定するDOI]や[fileのtype]には適切な正規表現パタンを記述する． 後でfileをダウンロードするときにファイル名を保持したいので(url,name)を値に持つリストであるtargetlistを作っている． データのダウンロード wgetなどを利用しても良いが，-iオプション利用時に名前を指定する方法がよくわからなかったので引き続きpythonで作業した． 大体こんな感じ． import os , urllib.request # 出力先の指定 OUTPURDIR = [ 出力先のディレクトリ ] # fileのダウンロード for item in targetlist : outputfilepath = os . path . join ( OUTPUTDIR , item [ 0 ]) # 既にファイルが存在する場合は保存しない if not os . path . exists ( outputfilepath ): urllib . request . urlretrieve ( item [ 1 ], outputfilepath ) 今後の課題 以上のように，pythonを使うとDataverseのデータを割と簡単に取得できた． しかし，ホントはもっとdataverseのapiを駆使してシンプルに操作すべきだと思う． Search APIのfqオプションの働きがよくわからず，例に上がっていたfq=publication_date_s:2015すらうまく機能しなかった． また Data Access API も存在するので もう少し賢くダウンロード出来たかもしれない． dataverseのAPI Search API Data Access API","title":"Dataverseから画像データをまとめて取得する","tags":"Life(Research)hack","url":"http://noshita.github.io/posts/00004.html"},{"text":"不備があれば御連絡下さい． noshita at morphometrics.jp","title":"引っ越しました","tags":"News","url":"http://noshita.github.io/posts/00001.html"}]}